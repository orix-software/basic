language: c
before_install:
    - sudo apt-get update -qq
    - sudo apt-get install -qq curl
    # - sudo pip install --upgrade pip
    # - sudo pip install mkdocs
    # - git clone https://github.com/oric-software/buildTestAndRelease.git
    # - cd buildTestAndRelease/ && sh make.sh
    #- pushd ..
    - git clone https://github.com/fachat/xa65.git
    - pushd xa65/xa && make &> /dev/null
    - cp file65 ldo65 reloc65 xa /home/travis/bin
    - VERSION=`cat src/VERSION`
    - mkdir orix/usr/share/basic/$VERSION -p && cp build/cart/basicsd.rom orix/usr/share/basic/$VERSION/basicsd.rom
    - mkdir orix/etc/orixcfg/$VERSION/ && echo "Basicsd v$VERSION joy/sd;/usr/share/basic/$VERSION/basicsd.rom" > orix/etc/orixcfg/$VERSION/basic.cnf
    - cd orix && tar -c * > ../basic.tar &&	cd ..
    - gzip basic.tar
    - mv basic.tar.gz basic.tgz
    - curl -X POST --data-binary '@basic.tgz' https://cdn.oric.org/publish.php?hash=$hash&path=/home/oricoujr/www/ftp/orix/dists/$VERSION/tgz/6502/basic.tgz    
    - popd    
